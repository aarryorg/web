<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thumbly AI - AI Thumbnail Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        .lds-ring {
            display: inline-block;
            position: relative;
            width: 40px;
            height: 40px;
        }
        .lds-ring div {
            box-sizing: border-box;
            display: block;
            position: absolute;
            width: 32px;
            height: 32px;
            margin: 4px;
            border: 4px solid #fff;
            border-radius: 50%;
            animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
            border-color: #fff transparent transparent transparent;
        }
        .lds-ring div:nth-child(1) {
            animation-delay: -0.45s;
        }
        .lds-ring div:nth-child(2) {
            animation-delay: -0.3s;
        }
        .lds-ring div:nth-child(3) {
            animation-delay: -0.15s;
        }
        @keyframes lds-ring {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
        .glassmorphism {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="bg-gray-900 text-white">

    <div class="min-h-screen bg-gradient-to-br from-gray-900 via-purple-900/50 to-gray-900 p-4 sm:p-6 lg:p-8">
        <div class="max-w-6xl mx-auto">

            <!-- Header -->
            <header class="text-center py-12">
                <h1 class="text-4xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-cyan-400 mb-4">
                    Thumbly AI
                </h1>
                <p class="text-lg md:text-xl text-gray-300 max-w-3xl mx-auto">
                    Create stunning, click-worthy YouTube thumbnails in seconds. Leverage AI to generate unique images from text or instantly grab high-quality thumbnails from any video URL.
                </p>
                <a href="#generator" class="mt-8 inline-block bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-full transition-transform duration-300 transform hover:scale-105">
                    Start Creating Now
                </a>
            </header>

            <!-- Features Section -->
            <section class="py-16">
                <div class="grid md:grid-cols-3 gap-8 text-center">
                    <div class="glassmorphism p-8 rounded-2xl">
                        <div class="flex items-center justify-center h-16 w-16 rounded-full bg-purple-500/20 mx-auto mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-purple-400"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>
                        </div>
                        <h3 class="text-xl font-bold mb-2">AI-Powered Creativity</h3>
                        <p class="text-gray-400">Describe your ideal thumbnail and let our AI bring it to life with vibrant, unique imagery tailored to your content.</p>
                    </div>
                    <div class="glassmorphism p-8 rounded-2xl">
                         <div class="flex items-center justify-center h-16 w-16 rounded-full bg-cyan-500/20 mx-auto mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-cyan-400"><path d="M15 2H9a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2Z"/><path d="M12 18h.01"/></svg>
                        </div>
                        <h3 class="text-xl font-bold mb-2">Instant URL Grabber</h3>
                        <p class="text-gray-400">Need a thumbnail fast? Just paste any YouTube video URL to instantly download its highest-resolution thumbnail.</p>
                    </div>
                    <div class="glassmorphism p-8 rounded-2xl">
                        <div class="flex items-center justify-center h-16 w-16 rounded-full bg-green-500/20 mx-auto mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-green-400"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
                        </div>
                        <h3 class="text-xl font-bold mb-2">High-Quality Downloads</h3>
                        <p class="text-gray-400">Export your generated thumbnails in high quality, ready to be uploaded directly to YouTube to capture your audience's attention.</p>
                    </div>
                </div>
            </section>

            <!-- Generator Section -->
            <section id="generator" class="pt-16">
                <div class="w-full max-w-3xl mx-auto bg-gray-800/50 rounded-2xl shadow-2xl p-6 md:p-10 border border-gray-700">
                    <div class="text-center mb-6">
                        <h2 class="text-3xl md:text-4xl font-bold text-cyan-400">Create Your Thumbnail</h2>
                        <p class="text-gray-400 mt-2">Enter a URL or a descriptive prompt below.</p>
                    </div>
                    <div class="space-y-4 mb-6">
                        <label for="youtube-url-input" class="block text-gray-300 text-sm font-semibold">YouTube Video URL (Optional)</label>
                        <input type="text" id="youtube-url-input" class="w-full p-3 bg-gray-700 rounded-lg border border-gray-600 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-shadow duration-300" placeholder="e.g., https://www.youtube.com/watch?v=dQw4w9WgXcQ">
                        <div class="flex items-center justify-center text-gray-400 text-sm">
                            <span class="w-full border-t border-gray-600"></span>
                            <span class="mx-4 font-bold">OR</span>
                            <span class="w-full border-t border-gray-600"></span>
                        </div>
                        <label for="prompt-input" class="block text-gray-300 text-sm font-semibold">Prompt for AI Thumbnail</label>
                        <textarea id="prompt-input" rows="3" class="w-full p-4 bg-gray-700 rounded-lg border border-gray-600 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition-shadow duration-300 resize-none" placeholder="e.g., A majestic lion wearing a crown, cinematic lighting"></textarea>
                        <button id="generate-btn" class="w-full flex items-center justify-center gap-2 py-3 px-4 bg-purple-600 hover:bg-purple-700 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 active:scale-95 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-purple-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>
                            Generate Thumbnail
                        </button>
                    </div>
                    <div class="mt-8">
                        <h3 class="text-xl font-semibold text-gray-300 mb-3">Your Thumbnail:</h3>
                        <div id="result-container" class="w-full aspect-video flex items-center justify-center bg-gray-900 rounded-lg border border-gray-700 p-2 relative overflow-hidden">
                            <div id="loader" class="hidden flex-col items-center justify-center text-gray-400">
                                <div class="lds-ring"><div></div><div></div><div></div><div></div></div>
                                <p class="mt-2 text-sm">Generating AI thumbnail...</p>
                            </div>
                            <p id="placeholder" class="text-gray-500 px-4 text-center">Your generated thumbnail will appear here.</p>
                            <p id="error-message" class="text-red-400 hidden absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-center"></p>
                            <img id="thumbnail-image" src="" alt="Generated Thumbnail" class="w-full h-full object-contain hidden rounded-md">
                            <a id="download-btn" class="absolute bottom-4 right-4 bg-green-600 hover:bg-green-700 text-white p-2 rounded-full shadow-lg transition-all duration-300 transform scale-0 opacity-0 group-hover:scale-100 group-hover:opacity-100" download="youtube_thumbnail.png" title="Download Thumbnail">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
                            </a>
                        </div>
                    </div>
                </div>
            </section>

             <!-- Footer -->
            <footer class="text-center py-12 mt-16 border-t border-gray-800">
                <p class="text-gray-500">&copy; 2024 Thumbly AI. All Rights Reserved.</p>
            </footer>
        </div>
    </div>

    <script>
        // --- All the JavaScript from the previous version is unchanged ---
        // --- It is included here for the app to be self-contained ---
        const generateBtn = document.getElementById('generate-btn');
        const youtubeUrlInput = document.getElementById('youtube-url-input');
        const promptInput = document.getElementById('prompt-input');
        const resultContainer = document.getElementById('result-container');
        const placeholder = document.getElementById('placeholder');
        const loader = document.getElementById('loader');
        const errorMessage = document.getElementById('error-message');
        const thumbnailImage = document.getElementById('thumbnail-image');
        const downloadBtn = document.getElementById('download-btn');

        generateBtn.addEventListener('click', generateThumbnail);
        
        promptInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                generateThumbnail();
            }
        });

        async function generateThumbnail() {
            const youtubeUrl = youtubeUrlInput.value.trim();
            const prompt = promptInput.value.trim();

            if (!youtubeUrl && !prompt) {
                showError("Please enter either a YouTube URL or a prompt.");
                return;
            }
            
            showLoading(true);

            try {
                if (youtubeUrl) {
                    const videoIdMatch = youtubeUrl.match(/(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/|v\/|)([\w-]{11})(?:\S+)?/);
                    if (videoIdMatch && videoIdMatch[1]) {
                        const videoId = videoIdMatch[1];
                        const thumbnailUrl = `https://img.youtube.com/vi/${videoId}/maxresdefault.jpg`;
                        await checkAndDisplayYoutubeThumbnail(thumbnailUrl, videoId);
                    } else {
                        throw new Error("Invalid YouTube URL provided.");
                    }
                } else if (prompt) {
                    const apiKey = ""; // Canvas environment provides this
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict?key=${apiKey}`;
                    const payload = {
                        instances: { prompt: prompt },
                        parameters: { "sampleCount": 1 }
                    };
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error?.message || `HTTP error! Status: ${response.status}`);
                    }
                    const result = await response.json();
                    
                    if (result.predictions && result.predictions.length > 0 && result.predictions[0].bytesBase64Encoded) {
                        const imageUrl = `data:image/png;base64,${result.predictions[0].bytesBase64Encoded}`;
                        showResult(imageUrl, 'image/png');
                    } else {
                        showError("No image was generated. Please try a different prompt.");
                    }
                }

            } catch (error) {
                console.error("Error generating thumbnail:", error);
                showError(`An error occurred: ${error.message}.`);
            } finally {
                showLoading(false);
            }
        }

        async function checkAndDisplayYoutubeThumbnail(url, videoId) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.onload = () => {
                    if (img.width > 120) {
                        showResult(url, 'image/jpeg');
                        resolve();
                    } else {
                        const fallbackUrl = `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`;
                        const fallbackImg = new Image();
                        fallbackImg.onload = () => { showResult(fallbackUrl, 'image/jpeg'); resolve(); };
                        fallbackImg.onerror = () => { reject(new Error("Could not load YouTube thumbnail.")); };
                        fallbackImg.src = fallbackUrl;
                    }
                };
                img.onerror = () => {
                    const fallbackUrl = `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`;
                    const fallbackImg = new Image();
                    fallbackImg.onload = () => { showResult(fallbackUrl, 'image/jpeg'); resolve(); };
                    fallbackImg.onerror = () => { reject(new Error("Could not load YouTube thumbnail.")); };
                    fallbackImg.src = fallbackUrl;
                };
                img.src = url;
            });
        }

        function showLoading(isLoading) {
            if (isLoading) {
                loader.classList.remove('hidden');
                loader.classList.add('flex');
                placeholder.classList.add('hidden');
                thumbnailImage.classList.add('hidden');
                errorMessage.classList.add('hidden');
                downloadBtn.classList.remove('scale-100', 'opacity-100');
                downloadBtn.classList.add('scale-0', 'opacity-0');
                generateBtn.disabled = true;
                generateBtn.classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                loader.classList.add('hidden');
                loader.classList.remove('flex');
                generateBtn.disabled = false;
                generateBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }
        
        function showResult(imageUrl, mimeType) {
            thumbnailImage.src = imageUrl;
            thumbnailImage.classList.remove('hidden');
            placeholder.classList.add('hidden');
            errorMessage.classList.add('hidden');
            
            downloadBtn.href = imageUrl;
            if (mimeType === 'image/png') {
                downloadBtn.download = 'ai_generated_thumbnail.png';
            } else if (mimeType === 'image/jpeg') {
                downloadBtn.download = 'youtube_thumbnail.jpg';
            }
            downloadBtn.classList.remove('scale-0', 'opacity-0');
            downloadBtn.classList.add('scale-100', 'opacity-100');
            resultContainer.classList.add('group');
        }

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.remove('hidden');
            placeholder.classList.remove('hidden');
            thumbnailImage.classList.add('hidden');
            downloadBtn.classList.remove('scale-100', 'opacity-100');
            downloadBtn.classList.add('scale-0', 'opacity-0');
            resultContainer.classList.remove('group');
        }
    </script>
</body>
</html>

